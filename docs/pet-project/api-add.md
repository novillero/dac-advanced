# Подключение OpenAPI

## Очень кратко об API

API — это программный интерфейс, то есть описание способов взаимодействия одной компьютерной программы с другими; набор способов и правил, по которым различные программы общаются между собой и обмениваются данными.

Используя API, вы можете получать от сервиса нужную информацию, передавать свою и даже выполнять некоторые функции приложения, оставаясь «в стороне».

REST API — это архитектурный подход, определяющий набор рекомендаций к проектированию API.

Принципы REST API:

* Клиент-серверная модель (client-server model).
* Отсутствие состояния (statelessness).
* Кэширование (cacheability).
* Единообразие интерфейса (uniform interface).
* Многоуровневая система (layered system).
* Код по требованию (code on demand) — необязательно.

Чаще всего архитектурный стиль REST применяют вместе со стандартом HTTP.

HTTP — это протокол передачи данных по сети, который представляет список правил, по которым устройства в сети обмениваются информацией по модели «клиент-сервер».

Клиент-сервисное взаимодействие предусматривает отправку запросов от клиента серверу и ответов на запросы — от сервера обратно клиенту.

Среди прочего в HTTP указан набор действий, которые клиент может совершать на сервере. Эти действия описываются методами HTTP-запроса по модели CRUD:

* Create (создание): метод POST.
* Read (чтение): метод GET.
* Update (обновление): методы PUT и PATCH.
* Delete (удаление): метод DELETE.

При проектировании REST API с HTTP используются HTTP-методы:

* POST — для создания нового ресурса.
* GET — для получения данных существующего ресурса.
* PUT и PATCH для полного или частичного обновления ресурса.
* DELETE для удаления ресурса.

Справочник API — это документ, в котором хранится подробное описание API:

1. Список всех доступных методов и эндпоинтов (конечных точек приложения, к которым клиент обращается для выполнения определённой операции).
2. Структура запросов и ответов.
3. Примеры запросов и ответов.
4. Ошибки и коды ошибок.

OpenAPI — стандартный формат описания REST API. 

Спецификация OpenAPI — это json или yaml-файл, в котором описаны все элементы API.

Для генерации интерактивной документации по спецификации OpenAPI используются инструменты визуализации:

* Swagger IO
* Redoc

## Подключение документации OpenAPI

1. Добавьте файл со спецификацией OpenAPI в проект в папку `docs`.

2. Для интеграции документации OpenApi в проект MkDocs Material можно подключить специальные плагины:

    * В формате Swagger — `swagger-ui-tag`
    * В формате Redoc — `redoc-tag`

    === "`swagger-ui-tag`"

        1. Установите плагин с помощью пакетного менеджера python:

            ```
            pip install mkdocs-swagger-ui-tag
            ```

        2. Подключите плагин в конфиге проекта:

            ```yaml title="mkdocs.yml"
            plugins:
              - search
              - swagger-ui-tag
            ```

        3. Создайте md-файл для размещения документации.

        4. Добавьте в md-файл тег:

            ```
            <swagger-ui src="путь_до_спецификации"/>
            ```

            !!! quote "Пример"
                ```
                <swagger-ui src="../../openapi.yml"/>
                ```
        
        5. Добавьте md-файл в конфиг проекта в раздел `nav`:

            ```yaml title="mkdocs.yml"
            nav:
              - Материалы курса:
                - index.md
                - API-дока: api/api-doc.md
            ```

        **Результат**: при сборке проекта по тегу на страницу подтянется сгенерированная документация.

    === "`redoc-tag`"

        1. Установите плагин с помощью пакетного менеджера python:

            ```
            pip install mkdocs-redoc-tag
            ```

        2. Подключите плагин в конфиге проекта:

            ```yaml title="mkdocs.yml"
            plugins:
              - search
              - sredoc-tag
            ```

        3. Создайте md-файл для размещения документации.

        4. Добавьте в md-файл тег:

            ```
            <redoc src="путь_до_спецификации"/>
            ```

            !!! quote "Пример"
                ```
                <redoc src="../../openapi.yml"/>
                ```
        
        5. Добавьте md-файл в конфиг проекта в раздел `nav`:

            ```yaml title="mkdocs.yml"
            nav:
              - Материалы курса:
                - index.md
                - API-дока: api/api-doc.md
            ```

        **Результат**: при сборке проекта по тегу на страницу подтянется сгенерированная документация.

## Полезные ссылки

* Плагин [mkdocs-swagger-ui-tag](https://github.com/blueswen/mkdocs-swagger-ui-tag){target=_blank};
* Плагин [mkdocs-redoc-tag](https://github.com/blueswen/mkdocs-redoc-tag){target=_blank}.

